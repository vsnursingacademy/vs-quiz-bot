import { supabaseAdmin } from '@/lib/supabaseAdmin';
export default async function handler(req,res){const { data } = await supabaseAdmin.from('attempts').select('id,quiz_id,user_id,score,started_at,finished_at');const rows=data||[];const header=['id','quiz_id','user_id','score','started_at','finished_at'];const csv=[header.join(',')].concat(rows.map(r=>header.map(h=>`"${(r[h]??'').toString().replace(/"/g,'""')}"`).join(','))).join('\n');res.setHeader('Content-Type','text/csv');res.setHeader('Content-Disposition','attachment; filename="attempts.csv"');res.status(200).send(csv);}
